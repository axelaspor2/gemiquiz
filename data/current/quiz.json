{
  "id": "pde-20260122-bigquery-data-transf",
  "exam_code": "PDE",
  "domain": "データの取り込みと処理",
  "section": "データソースの取り込み",
  "topic": "BigQuery Data Transfer Service",
  "difficulty": "medium",
  "question": "BigQuery Data Transfer Service を使用して、Google Cloud Storage から BigQuery データセットへデータを定期的に転送するジョブを構成しました。設定自体はエラーなく完了しましたが、スケジュールされた転送ジョブの実行履歴を確認すると「Permission denied」というエラーメッセージが表示され、転送が失敗していました。この問題を解決するために最初に行うべき対応はどれですか？",
  "options": [
    "転送設定を作成したユーザーに roles/bigquery.admin 役割が付与されているかを確認し、不足していれば付与する。",
    "BigQuery Data Transfer Service のサービスエージェント（p{PROJECT_NUMBER}@gcp-sa-bigquerydatatransfer.iam.gserviceaccount.com）に、転送先データセットに対する roles/bigquery.dataEditor 役割が付与されているか確認する。",
    "Cloud Storage バケットの権限設定を確認し、転送設定を作成したユーザーに roles/storage.objectViewer 役割が付与されているか確認する。",
    "プロジェクトの API ライブラリで BigQuery Data Transfer API が無効になっていないか確認し、無効であれば有効化する。"
  ],
  "correct": 1,
  "explanation": "BigQuery Data Transfer Service (DTS) が実行時に「Permission denied」や「Table does not exist」などのエラーを返す場合、多くは DTS のサービスエージェントに必要な権限が不足していることが原因です。DTS はユーザーに代わってバックグラウンドでジョブを実行するため、サービスエージェント（形式: p{PROJECT_NUMBER}@gcp-sa-bigquerydatatransfer.iam.gserviceaccount.com）が転送先データセットにデータを書き込むための「BigQuery データ編集者 (roles/bigquery.dataEditor)」役割を持っている必要があります。ユーザー自身に権限があっても、サービスエージェントに権限がないと実行時に失敗します。Aは作成権限に関わるもので、実行時の失敗とは異なります。Cはユーザーの権限ですが、DTS実行時はサービスアカウント/エージェントの権限が重要です。DはAPIが無効であれば設定自体ができません。"
}