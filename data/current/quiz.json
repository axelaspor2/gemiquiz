{
  "id": "pmle-20260205-tensorflow-pytorch-s",
  "exam_code": "PMLE",
  "domain": "チーム内およびチーム間の連携によるデータとモデルの管理",
  "section": "Jupyter ノートブックを使用したモデルのプロトタイピング",
  "topic": "TensorFlow・PyTorch・sklearn・JAX を使用したモデル開発",
  "difficulty": "medium",
  "question": "Vertex AI Workbench の Jupyter ノートブックで scikit-learn を使用したモデルのプロトタイピングを行っています。トレーニング済みモデルの `predict()` メソッドを使用して、テストデータセットから抽出した単一のサンプルに対して推論を試みたところ、`ValueError: Expected 2D array, got 1D array instead` というエラーが発生しました。この問題を解決するための最も適切な対処法はどれですか？",
  "options": [
    "入力データ（1次元配列）に対して `reshape(1, -1)` を適用し、(1, n_features) の形式の2次元配列に変換してから `predict()` に渡す。",
    "モデルの入力形式を numpy 配列から Python の標準リスト形式に変換して、データの次元を意識せずに済むようにする。",
    "Vertex AI Workbench のマネージドノートブックのカーネルを再起動し、scikit-learn を最新バージョンにアップグレードする。",
    "エラーメッセージは特徴量の不一致を示唆しているため、モデルのトレーニングに使用した列数と推論データの列数が一致しているかを確認し、モデルを再学習させる。"
  ],
  "correct": 0,
  "explanation": "scikit-learn の `predict()` メソッドは、常に (サンプル数, 特徴量数) という形式の 2 次元配列を入力として期待します。単一のサンプル（1 次元配列）を渡すと、このエラーが発生します。`reshape(1, -1)` を使用することで、元のデータを保持したまま形状を (1, 特徴量数) の 2 次元配列に変換でき、エラーを解決できます。他の選択肢について、リストへの変換では解決せず、バージョンの問題でもありません。また、この特定のエラーメッセージは「次元」の不足を指しており、特徴量の数（列数）の不一致とは別の問題です。"
}