{
  "id": "pde-20260123-dataflow",
  "exam_code": "PDE",
  "domain": "データの取り込みと処理",
  "section": "データパイプラインの設計",
  "topic": "Dataflow のウィンドウ処理とトリガー",
  "difficulty": "medium",
  "question": "あるストリーミングデータパイプラインにおいて、1時間ごとの集計レポートを作成する必要があります。一部のデータはネットワークの遅延により、最大24時間遅れて到着することが判明しています。Google Cloud のベストプラクティスに従い、これらの遅延データを適切に集計に含めつつ、タイムリーにレポートを生成するための構成として、最も適切なものはどれですか？",
  "options": [
    "1時間の固定ウィンドウ（Fixed Window）を使用し、`withAllowedLateness` を24時間に設定する。",
    "グローバルウィンドウ（Global Window）を使用し、24時間ごとに発火するプロセスタイムトリガーを設定する。",
    "1時間のスライディングウィンドウ（Sliding Window）を使用し、デフォルトのトリガー設定のまま運用する。",
    "ギャップ期間を24時間に設定したセッションウィンドウ（Session Window）を使用する。"
  ],
  "correct": 0,
  "explanation": "Dataflow（Apache Beam）で遅延データを処理する際のベストプラクティスは、`withAllowedLateness` を使用して、ウォーターマークがウィンドウの終了時間を過ぎた後でもデータを受け入れる「許容される遅延時間」を指定することです。1時間ごとのレポート作成には固定ウィンドウ（Fixed Window）が最適であり、これに `withAllowedLateness` を組み合わせることで、遅れて到着したデータも適切な時間枠の集計に反映させることができます。他の選択肢について：グローバルウィンドウは時間ごとの区切りがありません。スライディングウィンドウは重複する時間枠用です。セッションウィンドウはアクティビティの無風状態に基づく動的なウィンドウであり、固定時間の集計には適していません。"
}