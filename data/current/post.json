{
  "quiz": {
    "id": "pde-20260124-etl-elt",
    "exam_code": "PDE",
    "domain": "データの取り込みと処理",
    "section": "データ処理の実装",
    "topic": "ETL / ELT パターンの選択",
    "difficulty": "hard",
    "question": "あるヘルスケア企業が、リアルタイム分析のためにストリーミングされる患者データを BigQuery に取り込もうとしています。このデータには機密性の高い個人情報 (PII) と保護対象保健情報 (PHI) が含まれています。厳格なコンプライアンス規制により、PII/PHI は永続ストレージ（データウェアハウスやステージングバケットを含む）に保存される前に必ず匿名化またはマスキングされる必要があります。また、データの処理には、外部の医療リファレンス API を使用した複雑なデータ強化（Enrichment）と、カスタムライブラリを必要とする高度なロジックが含まれます。Google Cloud のベストプラクティスに基づき、どのデータ処理パターンとサービスの組み合わせを選択すべきですか？",
    "options": [
      "BigQuery のストリーミング挿入（ELT パターン）を使用して生データを直接ロードし、BigQuery の動的データマスキングとストアドプロシージャを使用して変換を行う。",
      "Cloud Pub/Sub と Dataflow（ETL パターン）を使用してパイプラインを構築し、BigQuery に書き込む前に PII/PHI の匿名化、外部 API によるデータ強化、および複雑なロジックの適用を行う。",
      "Cloud Storage を着信ゾーンとして使用し、BigQuery Data Transfer Service を介してロード（ELT パターン）した後、BigQuery 内で SQL を使用して機密データの処理を行う。",
      "Cloud Data Fusion を使用して、ソースから BigQuery へデータを直接転送するパイプラインを構築し、ロード後に BigQuery ML を使用してデータのクレンジングと匿名化を行う。"
    ],
    "correct": 1,
    "explanation": "Google Cloud における ETL と ELT の選択基準において、このシナリオでは ETL (Extract-Transform-Load) パターンが推奨されます。主な理由は2つあります。1つ目はセキュリティとコンプライアンスです。PII/PHI が永続ストレージに保存される前に処理される必要がある場合、データがウェアハウス（BigQuery）やステージング（Cloud Storage）に到達する前に Dataflow などの処理レイヤーで匿名化を行う ETL が必須となります。2つ目は複雑な変換ロジックです。外部 API の呼び出しやカスタムライブラリを必要とする高度な変換は、SQL ベースの ELT よりも Dataflow（Apache Beam）のようなプログラミングベースの処理エンジンの方が適しています。他の選択肢（A, C, D）はすべて、機密データが処理される前に一度永続ストレージに保存される ELT パターンを採用しているため、コンプライアンス要件を満たせません。"
  },
  "message_id": "1464479603233128448",
  "channel_id": "1298251380527726645",
  "posted_at": "2026-01-24T04:39:06.222Z"
}