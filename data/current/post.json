{
  "quiz": {
    "id": "pde-20260124-",
    "exam_code": "PDE",
    "domain": "データの取り込みと処理",
    "section": "データ処理の実装",
    "topic": "バッチ処理とストリーム処理の違い",
    "difficulty": "hard",
    "question": "ある企業が、従来のバッチ処理パイプラインから Dataflow を使用したストリーム処理パイプラインへの移行を行いました。5分間の固定ウィンドウ（Fixed Windows）を使用してリアルタイムの集計を行っていますが、ネットワークの不安定さが原因で、一部のデータがウィンドウの終了（ウォーターマークの通過）から数分後に到着していることが判明しました。現在の設定ではこれらの遅延データが破棄されており、正確な集計結果が得られていません。最大10分までの遅延を許容し、遅延データが到着するたびに結果を補正したい場合、どのようなトラブルシューティングと修正を行うべきですか？",
    "options": [
      "PCollection に対して .withAllowedLateness() を 10 分に設定し、さらに累積された結果を更新するために適切なトリガー（Trigger）を構成する。",
      "Pub/Sub からの読み取り時に処理時刻（Processing Time）をイベント時刻として使用するように変更し、データが到着した瞬間にウィンドウに割り当てる。",
      "固定ウィンドウをセッションウィンドウ（Session Windows）に変更し、ギャップ期間を 10 分に設定することで、遅延データが同じウィンドウに属するようにする。",
      "Dataflow ジョブのワーカー数を増やしてスループットを向上させ、データが Pub/Sub に到着してから Dataflow で処理されるまでの時間を短縮する。"
    ],
    "correct": 0,
    "explanation": "ストリーム処理において、イベント時刻（Event Time）がウォーターマーク（Watermark）を超えて到着したデータは「遅延データ」と見なされます。デフォルトでは、ウォーターマークがウィンドウの終了時刻を過ぎるとウィンドウはクローズされ、それ以降に到着したデータは破棄されます。この問題を解決するには、`withAllowedLateness` を使用してウィンドウの保持期間を延長し、さらに遅延データが到着した際に出力を再トリガーする設定（例：`AfterWatermark.pastEndOfWindow().withLateFirings(...)`）が必要です。選択肢Bは処理時刻に依存するためイベント時刻の正確性が失われ、選択肢Cはウィンドウの定義自体が変わってしまい、選択肢Dはスループットの向上には寄与しますが、論理的な遅延データの処理問題そのものを解決するものではありません。"
  },
  "message_id": "1464548487587958815",
  "channel_id": "1298251380527726645",
  "posted_at": "2026-01-24T09:12:49.578Z"
}