---
name: writing-plans
description: コードに触れる前に、複数ステップのタスクの仕様や要件がある場合に使用してください
---

# 作業計画の作成

## 概要

コードベースに関する知識が全くなく、センスにも疑問符が付くようなエンジニアを想定し、網羅的な実装計画を作成します。タスクごとにどのファイルを修正するか、コード、テスト、参照すべきドキュメント、テスト方法など、エンジニアが必要とする情報をすべて文書化してください。計画全体を、消化しやすい小さなタスクに分割して提示します。DRY（Don't Repeat Yourself）、YAGNI（You Ain't Gonna Need It）、TDD（Test-Driven Development）、こまめなコミットを実践してください。

エンジニアは有能な開発者であることを前提としますが、ツールの使い方や問題領域についてはほとんど知らないと仮定します。また、優れたテスト設計についてもあまり知らないと仮定します。

**開始時にアナウンス:** 「writing-plans スキルを使用して実装計画を作成します。」

**コンテキスト:** これは専用のワークツリー（brainstorming スキルで作成）で実行する必要があります。

**計画の保存場所:** `docs/plans/YYYY-MM-DD-<機能名>.md`

## タスクの粒度

**各ステップは1つのアクション（2～5分）とします:**
- 「失敗するテストを書く」- ステップ
- 「実行して失敗することを確認する」- ステップ
- 「テストをパスさせるための最小限のコードを実装する」- ステップ
- 「テストを実行してパスすることを確認する」- ステップ
- 「コミットする」- ステップ

## 計画ドキュメントのヘッダー

**すべての計画は、このヘッダーから始める必要があります:**

```markdown
# [機能名] 実装計画

> **Claudeへ:** REQUIRED SUB-SKILL: この計画をタスクごとに実行するために superpowers:executing-plans を使用してください。

**目標:** [この機能が構築するものを説明する1文]

**アーキテクチャ:** [アプローチに関する2～3文]

**技術スタック:** [主要なテクノロジー/ライブラリ]

---
```

## タスクの構造

```markdown
### タスク N: [コンポーネント名]

**ファイル:**
- 作成: `exact/path/to/file.py`
- 修正: `exact/path/to/existing.py:123-145`
- テスト: `tests/exact/path/to/test.py`

**ステップ 1: 失敗するテストを書く**

```python
def test_specific_behavior():
    result = function(input)
    assert result == expected
```

**ステップ 2: テストを実行して失敗することを確認する**

実行: `pytest tests/path/test.py::test_name -v`
期待される結果: FAIL "function not defined" と表示される

**ステップ 3: 最小限の実装を書く**

```python
def function(input):
    return expected
```

**ステップ 4: テストを実行してパスすることを確認する**

実行: `pytest tests/path/test.py::test_name -v`
期待される結果: PASS

**ステップ 5: コミットする**

```bash
git add tests/path/test.py src/path/file.py
git commit -m "feat: add specific feature"
```
```

## 覚えておくこと
- ファイルパスは常に正確に
- 計画には完全なコードを記述する（「バリデーションを追加する」のような記述ではない）
- 期待される出力を含む正確なコマンド
- 関連するスキルは@記法で参照する
- DRY、YAGNI、TDD、こまめなコミット

## 実行の引き渡し

計画を保存した後、実行方法の選択肢を提示します:

**「計画が完了し、`docs/plans/<ファイル名>.md` に保存されました。実行方法は2つあります:**

**1. サブエージェント駆動（このセッション）** - 各タスクごとに新しいサブエージェントを起動し、タスク間でレビューを行い、迅速なイテレーションを行います。

**2. 並列セッション（別）** - executing-plans を使用して新しいセッションを開き、チェックポイントを設定してバッチ実行します。

**どちらのアプローチにしますか？」**

**サブエージェント駆動が選択された場合:**
- **REQUIRED SUB-SKILL:** superpowers:subagent-driven-development を使用する
- このセッションに留まる
- 各タスクごとに新しいサブエージェントを起動し、コードレビューを行う

**並列セッションが選択された場合:**
- ワークツリーで新しいセッションを開くように指示する
- **REQUIRED SUB-SKILL:** 新しいセッションでは superpowers:executing-plans を使用する